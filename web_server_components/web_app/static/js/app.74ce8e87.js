(function(e){function t(t){for(var r,c,i=t[0],u=t[1],s=t[2],f=0,d=[];f<i.length;f++)c=i[f],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&d.push(o[c][0]),o[c]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);l&&l(t);while(d.length)d.shift()();return a.push.apply(a,s||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,i=1;i<n.length;i++){var u=n[i];0!==o[u]&&(r=!1)}r&&(a.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},o={app:0},a=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var l=u;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0fe3":function(e,t,n){"use strict";n("e51b")},1497:function(e,t,n){"use strict";n("1eea")},"1eea":function(e,t,n){},"3f99":function(e,t,n){"use strict";n("f34b")},4196:function(e,t,n){"use strict";n("d0a3")},5380:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),o={class:"container"};function a(e,t,n,a,c,i){var u=Object(r["v"])("Header"),s=Object(r["v"])("router-view");return Object(r["o"])(),Object(r["d"])("div",o,[Object(r["f"])(u,{title:"LPR Detections List"}),Object(r["f"])(s)])}var c=Object(r["D"])("data-v-63c5b556"),i=c((function(e,t,n,o,a,c){return Object(r["o"])(),Object(r["d"])("header",null,[Object(r["f"])("h1",null,Object(r["x"])(n.title),1)])})),u={name:"Header",props:{title:String}};n("4196");u.render=i,u.__scopeId="data-v-63c5b556";var s=u,l={name:"App",components:{Header:s}};n("f340");l.render=a;var f=l,d=n("6c02"),p=Object(r["D"])("data-v-6b14c5ca");Object(r["r"])("data-v-6b14c5ca");var b={class:"logout"};Object(r["p"])();var m=p((function(e,t,n,o,a,c){var i=Object(r["v"])("Button"),u=Object(r["v"])("Filter"),s=Object(r["v"])("Detections"),l=Object(r["v"])("PageBar");return Object(r["o"])(),Object(r["d"])(r["a"],null,[Object(r["f"])("div",b,[Object(r["f"])(i,{text:"Logout",onClick:c.logout},null,8,["onClick"]),Object(r["f"])(u,{onResetFilters:c.resetFilters,onDoSearch:c.doSearch},null,8,["onResetFilters","onDoSearch"])]),Object(r["f"])(s,{onToggleWrong:c.toggleWrong,detections:a.detections},null,8,["onToggleWrong","detections"]),Object(r["f"])(l,{onPreviousPage:c.prevPage,onNextPage:c.nextPage,pages:a.pages},null,8,["onPreviousPage","onNextPage","pages"])],64)})),g=n("5530"),v=n("1da1");n("96cf"),n("d3b7"),n("1276"),n("ac1f"),n("d81d");function j(e,t,n,o,a,c){var i=Object(r["v"])("Detection");return Object(r["o"])(!0),Object(r["d"])(r["a"],null,Object(r["u"])(n.detections,(function(t){return Object(r["o"])(),Object(r["d"])("div",{key:t.id},[Object(r["f"])(i,{onToggleWrong:function(n){return e.$emit("toggle-wrong",t.id)},detection:t},null,8,["onToggleWrong","detection"])])})),128)}function O(e,t,n,o,a,c){return Object(r["o"])(),Object(r["d"])("div",{onDblclick:t[1]||(t[1]=function(t){return e.$emit("toggle-wrong",n.detection.id)}),class:[n.detection.marked_as_error?"wrong":"","detection"]},[Object(r["f"])("h3",null,Object(r["x"])(n.detection.license_plate),1),Object(r["f"])("p",null,"Event time: "+Object(r["x"])(n.detection.detection_time.split(".")[0].split("T")[0])+" "+Object(r["x"])(n.detection.detection_time.split(".")[0].split("T")[1]),1),Object(r["f"])("img",{src:n.detection.image,alt:"NOT FOUND"},null,8,["src"])],34)}var h={name:"Detection",props:{detection:Object}};n("3f99");h.render=O;var w=h,D={name:"Detections",props:{detections:Array},components:{Detection:w},emits:["toggle-wrong"]};D.render=j;var x=D,k=Object(r["D"])("data-v-6e21f051");Object(r["r"])("data-v-6e21f051");var y={class:"pages"};Object(r["p"])();var _=k((function(e,t,n,o,a,c){var i=Object(r["v"])("Button");return Object(r["o"])(),Object(r["d"])("div",y,[null!==n.pages.previous?(Object(r["o"])(),Object(r["d"])(i,{key:0,text:"Prev page",onClick:t[1]||(t[1]=function(t){return e.$emit("previous-page")})})):Object(r["e"])("",!0),null!==n.pages.next?(Object(r["o"])(),Object(r["d"])(i,{key:1,text:"Next page",onClick:t[2]||(t[2]=function(t){return e.$emit("next-page")})})):Object(r["e"])("",!0)])}));function S(e,t,n,o,a,c){return Object(r["o"])(),Object(r["d"])("button",{onClick:t[1]||(t[1]=function(e){return c.onClick()}),style:{color:n.color,background:n.background},class:"btn"},Object(r["x"])(n.text),5)}var P={name:"Button",props:{text:String,color:String,background:String},methods:{onClick:function(){this.$emit("btn-click")}}};P.render=S;var R=P,C={name:"PageBar",components:{Button:R},props:{pages:Object},emits:["previous-page","next-page"]};n("e806");C.render=_,C.__scopeId="data-v-6e21f051";var T=C,I=Object(r["D"])("data-v-760ba578"),B=I((function(e,t,n,o,a,c){var i=Object(r["v"])("Button"),u=Object(r["v"])("FilterForm");return Object(r["o"])(),Object(r["d"])(r["a"],null,[Object(r["C"])(Object(r["f"])(i,{onBtnClick:t[1]||(t[1]=function(e){return a.filterMode=!0}),text:"Filter"},null,512),[[r["A"],!a.filterMode]]),Object(r["C"])(Object(r["f"])("div",null,[Object(r["f"])(i,{onBtnClick:t[2]||(t[2]=function(t){e.$emit("reset-filters"),a.filterMode=!1}),text:"Reset"}),Object(r["f"])(u,{onDoSearch:c.doSearch},null,8,["onDoSearch"])],512),[[r["A"],a.filterMode]])],64)})),F=Object(r["D"])("data-v-047c3a39");Object(r["r"])("data-v-047c3a39");var N={class:"form-lp"},M=Object(r["f"])("label",null,"License plate",-1),A={class:"form-date"},$=Object(r["f"])("label",null,"Date range",-1),z=Object(r["f"])("div",{class:"search-submit"},[Object(r["f"])("input",{type:"submit",value:"Search",class:"search-btn"})],-1);Object(r["p"])();var L=F((function(e,t,n,o,a,c){return Object(r["o"])(),Object(r["d"])("form",{onSubmit:t[4]||(t[4]=function(){return c.onSubmit&&c.onSubmit.apply(c,arguments)}),class:"filter-form"},[Object(r["f"])("div",N,[M,Object(r["C"])(Object(r["f"])("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=function(e){return a.licensePlate=e}),name:"licensePlate"},null,512),[[r["z"],a.licensePlate]])]),Object(r["f"])("div",A,[$,Object(r["C"])(Object(r["f"])("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=function(e){return a.fromDate=e}),name:"fromDate",id:"fromDate"},null,512),[[r["z"],a.fromDate]]),Object(r["C"])(Object(r["f"])("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=function(e){return a.toDate=e}),name:"toDate",id:"toDate"},null,512),[[r["z"],a.toDate]])]),z],32)})),E=(n("25f0"),n("99af"),{name:"FilterForm",data:function(){return{licensePlate:"",fromDate:"",toDate:""}},methods:{onSubmit:function(e){if(e.preventDefault(),document.getElementById("fromDate").required=!1,document.getElementById("toDate").required=!1,!this.fromDate||!this.toDate)return document.getElementById("fromDate").required=!0,void(document.getElementById("toDate").required=!0);var t=this.toDate.split("-");t[2]=(parseInt(t[2])+1).toString(),this.toDate="".concat(t[0],"-").concat(t[1],"-").concat(t[2]);var n={licensePlate:this.licensePlate,fromDate:this.fromDate,toDate:this.toDate};this.$emit("do-search",n),this.licensePlate="",this.fromDate="",this.toDate=""}}});n("d311");E.render=L,E.__scopeId="data-v-047c3a39";var U=E,q={name:"Filter",components:{Button:R,FilterForm:U},data:function(){return{filterMode:!1}},methods:{doSearch:function(e){this.$emit("do-search",e)}},emits:["do-search","reset-filters"]};q.render=B,q.__scopeId="data-v-760ba578";var H=q,W={name:"Home",components:{Detections:x,PageBar:T,Filter:H,Button:R},data:function(){return{detections:[],pages:{},pageNum:null}},methods:{fetchDetections:function(){var e=arguments;return Object(v["a"])(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:"",t.next=3,fetch("/api/lpr/"+n,{credentials:"omit",headers:{"Content-type":"application/json",Authorization:"Token "+localStorage.getItem("authToken")}});case 3:return r=t.sent,t.next=6,r.json();case 6:return o=t.sent,t.abrupt("return",o);case 8:case"end":return t.stop()}}),t)})))()},fetchDetection:function(e){return Object(v["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/lpr/".concat(e,"/"),{credentials:"omit",headers:{"Content-type":"application/json",Authorization:"Token "+localStorage.getItem("authToken")}});case 2:return n=t.sent,t.next=5,n.json();case 5:return r=t.sent,t.abrupt("return",r);case 7:case"end":return t.stop()}}),t)})))()},getPages:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchDetections();case 2:n=t.sent,r=n["results"].length,n["count"]%r!==0?e.pageNum=Math.floor(n["count"]/r)+1:e.pageNum=Math.floor(n["count"]/r);case 5:case"end":return t.stop()}}),t)})))()},displayDetections:function(e){var t=this;return Object(v["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=null,t.pageNum){n.next=10;break}return n.next=4,t.getPages();case 4:return console.log(t.pageNum),n.next=7,t.fetchDetections("?page=".concat(t.pageNum));case 7:r=n.sent,n.next=13;break;case 10:return n.next=12,t.fetchDetections(e);case 12:r=n.sent;case 13:t.detections=r["results"].reverse(),t.pages={previous:r["next"],next:r["previous"]};case 15:case"end":return n.stop()}}),n)})))()},doSearch:function(e){var t=this;return Object(v["a"])(regeneratorRuntime.mark((function n(){var r,o,a,c,i,u,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r="?",o="&",a="T00:00:00.000000%2B04%3A00",c="license_plate="+e.licensePlate,i="time_range_after="+e.fromDate+a,u="time_range_before="+e.toDate+a,s=r+c+o+i+o+u,t.displayDetections(s);case 8:case"end":return n.stop()}}),n)})))()},resetFilters:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.pageNum=null,e.displayDetections();case 2:case"end":return t.stop()}}),t)})))()},nextPage:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.displayDetections(e.pages.next.split("/lpr/")[1]);case 1:case"end":return t.stop()}}),t)})))()},prevPage:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.displayDetections(e.pages.previous.split("/lpr/")[1]);case 1:case"end":return t.stop()}}),t)})))()},toggleWrong:function(e){var t=this;return Object(v["a"])(regeneratorRuntime.mark((function n(){var r,o,a,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.fetchDetection(e);case 2:return r=n.sent,o={marked_as_error:!r.marked_as_error},n.next=6,fetch("/api/lpr/".concat(e,"/"),{method:"PATCH",credentials:"omit",headers:{"Content-type":"application/json",Authorization:"Token "+localStorage.getItem("authToken")},body:JSON.stringify(o)});case 6:return a=n.sent,n.next=9,a.json();case 9:c=n.sent,t.detections=t.detections.map((function(t){return t.id===e?Object(g["a"])(Object(g["a"])({},t),{},{marked_as_error:c.marked_as_error}):t}));case 11:case"end":return n.stop()}}),n)})))()},logout:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:localStorage.removeItem("authToken"),e.$router.push("/login");case 2:case"end":return t.stop()}}),t)})))()}},created:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.displayDetections();case 1:case"end":return t.stop()}}),t)})))()},beforeRouteEnter:function(e,t,n){var r=localStorage.getItem("authToken");r?n():n("/login")}};n("0fe3");W.render=m,W.__scopeId="data-v-6b14c5ca";var V=W,J=Object(r["D"])("data-v-7e427098");Object(r["r"])("data-v-7e427098");var G={class:"form-control"},K=Object(r["f"])("label",null,"Login form",-1),Q=Object(r["f"])("input",{type:"submit",value:"Login",class:"login-submit-btn"},null,-1);Object(r["p"])();var X=J((function(e,t,n,o,a,c){return Object(r["o"])(),Object(r["d"])("form",{onSubmit:t[3]||(t[3]=function(){return c.onSubmit&&c.onSubmit.apply(c,arguments)}),class:"login-form"},[Object(r["f"])("div",G,[K,Object(r["C"])(Object(r["f"])("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=function(e){return a.username=e}),name:"username",placeholder:"Username"},null,512),[[r["z"],a.username]]),Object(r["C"])(Object(r["f"])("input",{type:"password","onUpdate:modelValue":t[2]||(t[2]=function(e){return a.password=e}),name:"password",placeholder:"Password"},null,512),[[r["z"],a.password]]),Q])],32)})),Y=(n("159b"),{name:"Login",data:function(){return{username:"",password:""}},methods:{onSubmit:function(e){var t=this;return Object(v["a"])(regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.preventDefault(),n.next=3,fetch("/api_token_auth/",{method:"POST",credentials:"omit",headers:{"Content-type":"application/x-www-form-urlencoded"},body:"username=".concat(t.username,"&password=").concat(t.password)}).then((function(e){return e.json()}));case 3:r=n.sent,t.username="",t.password="",r["token"]?(localStorage.setItem("authToken",r["token"]),t.$router.push("/")):(alert("Invalid password or/and username"),o=document.querySelectorAll("input"),o.forEach((function(e){e.required=!0})));case 7:case"end":return n.stop()}}),n)})))()}}});n("1497");Y.render=X,Y.__scopeId="data-v-7e427098";var Z=Y,ee=[{path:"/",name:"Home",component:V},{path:"/login",name:"Login",component:Z}],te=Object(d["a"])({history:Object(d["b"])("/"),routes:ee}),ne=te;Object(r["c"])(f).use(ne).mount("#app")},"8af9":function(e,t,n){},d0a3:function(e,t,n){},d311:function(e,t,n){"use strict";n("5380")},e51b:function(e,t,n){},e806:function(e,t,n){"use strict";n("8af9")},f340:function(e,t,n){"use strict";n("ffb9")},f34b:function(e,t,n){},ffb9:function(e,t,n){}});
//# sourceMappingURL=app.74ce8e87.js.map